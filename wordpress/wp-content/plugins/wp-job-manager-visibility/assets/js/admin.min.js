var $j=jQuery,jmrv={};jmrv.ajax={"new":function(a){jmrv.ajax.save(a)},update:function(){},remove:function(a,b){jmrv.ajax.save(a,b.data("user"))},save:function(a,b,c,d){var e=!0;jmrv.ajax.the_nonce="k+ZR1GFqj1zOMhYQK7hi9wEE",a.nonce=$j("#jmv-jmv_nonce").val(),a.post_id=$j("#jmv-post-id").val(),$j.ajax(ajaxurl,{type:"POST",dataType:"JSON",data:a,beforeSend:function(){},error:function(a,b,c){var d;if(a.responseText){d=a.responseText;var f=$j(".xdebug-error th:first",a.responseText).html();f&&(d=f)}else d=jmrvlocale.error+"! "+c;e=!1,jmrv.loader.show("fa-exclamation-triangle",d+"<br/>"+jmrvlocale.error_submit_ticket)},success:function(b){b.table&&$j("#jmv-mb-list-wrap").html(b.table),"error"==b.status&&b.message?jmrv.loader.show("fa-exclamation-triangle",b.message):(jmv_placeholder.clear(a),jmrv.loader.hide())},complete:function(){return c||(jmrv.callbacks.table(),jmv_placeholder.callbacks.list()),jmrv.fields.add.clear(b),e}})}},jmrv.alert={show:function(a,b){},hide:function(){}};var editing_user_id;jmrv.callbacks={actions:function(){$j("#jmv-loader").off().click(function(a){jmrv.loader.hide("fa-exclamation-triangle",!0)}),$j("#jmv-mb-add-add-btn").off().click(function(a){jmrv.loader.edit.hide(),jmrv.loader.show();var b=jmrv.fields.user.get(),c=jmrv.fields.user.get_display(),d=jmrv.fields.ph.get(),e=jmrv.fields.fields.get(),f={action:"jmrv_add",user_id:b,user:c,placeholder:d,fields:e};jmrv.ajax["new"](f),jmrv.fields.user.disable(b)}),$j("#jmv-mb-add-cancel-btn").off().click(function(a){editing_user_id&&jmrv.fields.user.disable(editing_user_id),jmrv.fields.add.clear(),jmrv.loader.edit.hide()})},table:function(){$j(".jmv-list-remove").off().click(function(a){jmrv.loader.show();var b=confirm(jmrvlocale.ays_remove);if(1==b){var c=$j(this).closest(".jmv-list-actions-td"),d={action:"jmrv_remove",post_id:c.data("post_id")};jmrv.ajax.remove(d,c)}else jmrv.loader.hide()}),$j(".jmv-list-edit").off().click(function(a){jmrv.loader.show(),jmrv.fields.add.clear(),jmrv.loader.hide(),jmrv.loader.edit.show();var b=$j(this).closest(".jmv-list-actions-td"),c=b.data("user_id"),d=b.data("fields").split(","),e=$j(this).closest(".jmv-list-ph-td").val();$j("#jmv-mb-add-ph-ta").val(e),jmrv.fields.user.enable(c),editing_user_id=c,$j.each(d,function(a,b){jmrv.fields.fields.select(b)}),jmrv.fields.fields.update(),jmrv.fields.fields.color(d)})}},jmrv.fields={add:{clear:function(a){a&&jmrv.fields.user.enable(a),jmrv.fields.user.update("",!0),$j("#jmv-mb-add-ph-ta").val(""),$j("#jmv-chosen-fields-add option").prop("selected",!1).trigger("chosen:updated"),$j("#jmv_chosen_fields_add_chosen .search-field input").addClass("default").css("width","auto")}},ph:{get:function(){return $j("#jmv-mb-add-ph-ta").val()}},fields:{select:function(a,b){$j("#jmv-chosen-fields-add optgroup option[value='"+a+"']").attr("selected","selected"),b&&jmrv.fields.fields.update()},unselect:function(a,b){$j("#jmv-chosen-fields-add optgroup option[value='"+a+"']").prop("selected",!1),b&&jmrv.fields.fields.update()},update:function(){$j("#jmv-chosen-fields-add").trigger("chosen:updated")},color:function(a){$j("#jmv_chosen_fields_add_chosen > .chosen-choices > li.search-choice").each(function(b,c){var d=($j("span",this).text(),$j("span",c).text());a.indexOf(d+"_show")>-1&&$j(c).addClass("jmv-mb-chosen-show"),a.indexOf(d+"_hide")>-1&&$j(c).addClass("jmv-mb-chosen-hide")})},get:function(){return $j("#jmv-chosen-fields-add").val()}},user:{disable:function(a,b){$j('#jmv-chosen-user-add optgroup option[value="'+a+'"]').prop("disabled",!0),b||jmrv.fields.user.update(a)},enable:function(a,b){$j('#jmv-chosen-user-add optgroup option[value="'+a+'"]').prop("disabled",!1),b||jmrv.fields.user.update(a)},update:function(a,b){(a||b)&&$j("#jmv-chosen-user-add").val(a),$j("#jmv-chosen-user-add").trigger("chosen:updated")},get:function(){return $j("#jmv-chosen-user-add").val()},get_display:function(){return $j("#jmv_chosen_user_add_chosen > .chosen-single > span").text()}}},jmrv.loader={show:function(a,b){a&&$j("#jmv-loader-wrap > .fa").removeClass("fa-cog").addClass(a),b&&$j("#jmv-loader-wrap > span").html(b),(a||b)&&($j("#jmv-loader-close").show(),$j("#jmv-loader-wrap").css("color","#EB1B1B")),$j("#jmv-loader").show()},hide:function(a,b){a&&$j("#jmv-loader-wrap > .fa").removeClass(a).addClass("fa-cog"),b&&$j("#jmv-loader-wrap > span").html(jmrvlocale.loading+"..."),(a||b)&&($j("#jmv-loader-close").hide(),$j("#jmv-loader-wrap").css("color","#adadad")),$j("#jmv-loader").hide()},edit:{show:function(){$j("#jmv-edit-loader").show(),$j(".jmv-mb-add-add-btn > span").removeClass("fa-user-plus").addClass("fa-floppy-o"),$j(".jmv-mb-add-cancel-btn").show()},hide:function(){$j(".jmv-mb-add-add-btn > span").removeClass("fa-floppy-o").addClass("fa-user-plus"),$j("#jmv-edit-loader").hide(),$j(".jmv-mb-add-cancel-btn").hide()}}};var jmv_placeholder={clear:function(a){if($j("#jmv-chosen-fields-add-ph option").prop("selected",!1).trigger("chosen:updated"),$j("#jmv-ph-add-ph-ta").val("").html("").empty(),a){if("jmv_remove"===a.action){var b=a.meta_key;$j("#jmv-chosen-visible-default_visibilities optgroup option[value='"+b+"']").attr("disabled",!1),$j("#jmv-chosen-visible-default_visibilities").trigger("chosen:updated")}if("jmv_add"===a.action){var b=a.meta_key;$j("#jmv-chosen-visible-default_visibilities optgroup option[value='"+b+"']").attr("disabled",!0),$j("#jmv-chosen-visible-default_visibilities").trigger("chosen:updated")}}},callbacks:{list:function(){$j(".jmv-ph-remove").off().click(function(a){jmrv.loader.show();var b=confirm(jmrvlocale.ays_remove);if(1==b){var c=$j(this).closest(".jmv-ph-actions-td"),d=c.data("meta_key"),e=$j("#jmv_user_id").val(),f={action:"jmv_remove",post_id:c.data("post_id"),meta_key:d,user_id:e};jmrv.ajax.save(f),jmv_placeholder.clear()}else jmrv.loader.hide()}),$j(".jmv-ph-edit").off().click(function(a){jmrv.loader.edit.show();var b=$j(this).closest(".jmv-ph-actions-td"),c=b.data("meta_key"),d=b.data("placeholder"),e=he.decode(d);$j("#jmv-ph-add-ph-ta").val(e).html(e),jmv_placeholder.dropdown.update(c)})}},dropdown:{disable:function(a,b){$j('#jmv-chosen-fields-add-ph optgroup option[value="'+a+'"]').prop("disabled",!0),b||jmrv.fields.user.update(a)},enable:function(a,b){$j('#jmv-chosen-fields-add-ph optgroup option[value="'+a+'"]').prop("disabled",!1),b||jmrv.fields.user.update(a)},update:function(a,b){(a||b)&&$j("#jmv-chosen-fields-add-ph").val(a),$j("#jmv-chosen-fields-add-ph").trigger("chosen:updated")}}};jQuery(function(a){a(".jmv-chosen-user-visibility_groups").chosen({search_contains:!0,width:"100%",include_group_label_in_selected:!0}).on("change",function(a,b){}),a("#jmv-chosen-user-default_visibilities").chosen({allow_single_deselect:!1,include_group_label_in_selected:!0,search_contains:!0,width:"100%"}).on("change",function(a,b){}),a("#jmv-chosen-visible-default_visibilities").chosen({search_contains:!0,include_group_label_in_selected:!0,width:"100%"}).on("change",function(a,b){}),a("#jmv-chosen-fields-add-ph").chosen({allow_single_deselect:!0,include_group_label_in_selected:!0,search_contains:!0,width:"100%"}).on("change",function(a,b){}),a("#jmv-ph-add-add-btn").click(function(){jmrv.loader.edit.hide(),jmrv.loader.show();var b=a("#jmv-chosen-fields-add-ph").val(),c=a("#jmv-ph-add-ph-ta").val(),d=$j("#jmv_user_id").val(),e={action:"jmv_add",placeholder:c,meta_key:b,user_id:d};jmrv.ajax.save(e)}),$j("#jmv-ph-add-cancel-btn").off().click(function(a){jmv_placeholder.clear(),jmrv.loader.edit.hide()}),jmv_placeholder.callbacks.list(),jmrv.loader.hide(),jmrv.callbacks.actions(),jmrv.callbacks.table()});