/**
 * WP Job Manager - Emails - v2.1.0 - 2017-04-21
 * Author: Myles McNamara
 * Website: https://plugins.smyl.es
 *
 * Copyright (c) 2017;
 */
jQuery(function(a){function b(){var b=a("#exclude_menu").children(".addition"),d=b.data("value");c(d)&&b.removeClass("disabled")}function c(a){var b=/\S+@\S+\.\S+/;return b.test(a)}function d(a){return a.post_title||(a.post_title=a.defaults.post_title?a.defaults.post_title:""),a.to||(a.to=a.defaults.to?a.defaults.to:""),a.subject||(a.subject=a.defaults.subject?a.defaults.subject:""),a.post_content||(a.post_content=a.defaults.post_content?a.defaults.post_content:""),a.attachments||(a.attachments=a.defaults.attachments?a.defaults.attachments:""),a}function e(b){var c=g(b),d=c.parent_slug;a(".shortcode_sb_dynamic").hide(),a(".shortcode_sb_head_dynamic").hide(),c.shortcodes&&(a.each(c.shortcodes,function(b,c){var d=".shortcode_"+b;a(d).show()}),a("."+d+"_hooks_sc_header").show())}function f(b,c,d){var e=h(b,c,d);if(e.post_title&&a("#post_title").val(e.post_title),e.to&&a("#to").val(e.to),e.subject&&a("#subject").val(e.subject),e.post_content)if(a("#wp-content-wrap").hasClass("tmce-active")){var f=e.post_content.replace(/\n/gi,"<br>");tinyMCE.activeEditor.setContent(f)}else a("#content").val(e.post_content);u.dropdown("set exactly",b),e.attachments&&s.dropdown("set exactly",e.attachments)}function g(a){return!(!jmemails_actions||!jmemails_actions[a])&&jmemails_actions[a]}function h(a,b,c){if(jmemails_templates&&jmemails_templates[b]&&jmemails_templates[b].templates){if(!c)var c=jmemails_templates[b].templates.map(function(a){return a.action}).indexOf(a);if(jmemails_templates[b].templates[c])return d(jmemails_templates[b].templates[c])}return!1}function i(b){var c=g(b);c&&(c.ext_desc?(a("#hook_description").html(c.ext_desc),a("#hook_description_message").transition("drop in")):a("#hook_description_message").transition("drop out"),c.warning?(a("#hook_req_description").html(c.warning),a("#hook_req_description_message").transition("drop in")):a("#hook_req_description_message").transition("drop out"))}function j(b){var c=g(b);if(c)if(a("#hook_form_fields").html(""),c.inputs){var d=a(c.inputs).length;a.each(c.inputs,function(b,c){var e=c.label?"<label>"+c.label+"</label>":"",f='name="'+b+'" type="'+c.type+'"';c.placeholder&&(f+=' placeholder="'+c.placeholder+'"'),"undefined"!=typeof c.saved_value?"checkbox"==c.type||"radio"==c.type?c.saved_value&&(f+=' checked="checked"'):f+=' value="'+c.saved_value+'"':"undefined"!=typeof c.default_value&&("checkbox"==c.type||"radio"==c.type?c.default_value&&(f+=' checked="checked"'):f+=' value="'+c.default_value+'"');var g='<input class="hook_form_input hook_form_'+b+'" '+f+">";if("radio"==c.type||"checkbox"==c.type){var h="undefined"!=typeof c.checkbox?c.checkbox+" "+c.type:c.type;g='<div class="ui '+h+'">'+g+e+"</div>",c.help&&(g+='<span data-inverted="" data-tooltip="'+c.help+'" data-variation="small" data-position="right center"><i class="ui icon question circular"</i></span>')}else{var i="",j="",k="";c.icon&&(i+=" "+c.icon.position+" icon",j+='<i class="'+c.icon.name+' icon"></i>'),c.help&&(i+=" right labeled",k+='<div class="ui icon label" data-inverted="" data-tooltip="'+c.help+'"><i class="fitted help circle icon" style="margin: 0em;"></i></div>'),g=j+g+k,i&&(g='<div class="ui'+i+' input">'+g+"</div>"),g=e+g}var l=c.inline||d<2?" inline":"";c.required&&(l+=" required");var m='<div class="field'+l+'">'+g+"</div>";a("#hook_form_fields").append(m)}),setTimeout(function(){a("#hook_form_wrap").show()},500)}else a("#hook_form_wrap").hide()}function k(b){var c=g(b);c.parent_slug;a(".jme_hidden_mb").addClass("jme_pending_update"),a(".hidden_sc_group").hide(),c&&c.metaboxes&&a.each(c.metaboxes,function(b,c){a("#"+c).removeClass("hide-if-js jme_pending_update"),a("."+c+"_sb_group").show()}),a(".jme_pending_update").addClass("hide-if-js").removeClass("jme_pending_update")}function l(b){var c={};return c.values=[],a.each(b,function(a,b){c.values.push({name:b,value:b})}),c}function m(b){var c=g(b);if(c)if(!c.attachment_fields||c.attachment_fields.length<=0)r.hide();else{r.show().dimmer("show");var d="i34THPj7nV+2agYiT30OBgEE",e=c.attachment_fields,f=l(e);s.dropdown("setup menu",f);var h=[],i=a("#attachments_dropdown_val").val().split(",");a.each(e,function(a,b){d&&i.length>0&&i.indexOf(b)!==-1&&h.push(b)}),h.length>0&&s.dropdown("set exactly",h),setTimeout(function(){r.dimmer("hide")},500)}}function n(b){b.length<=0||(a("#wp-content-wrap").hasClass("tmce-active")?tinyMCE.activeEditor.execCommand("mceInsertContent",!1,b):a("#content").insertAtCaret(b))}var o=!1,p=a("#hook_template_modal"),q=a("#hook_view_template_modal"),r=a("#attachments_mb"),s=a("#attachments_dropdown"),t=a("#hook_mb"),u=a("#hook_dropdown"),v=a("#sc_sidebar"),w=a("#hvt_use_template");a.fn.dropdown.settings.templates.addition=function(a){var b='<i class="icon search" style="background-color: inherit;"></i>';if(c(a))var d=' <div class="ui basic left pointing blue small label" style="margin-left: 10px;"><i class="add user icon"></i>'+jme_translations.click_to_add+a+"</div>";else var d=". "+jme_translations.enter_valid_email;return b+=o?jme_translations.search_results:jme_translations.no_users_found,b+="<strong> "+a+" </strong>"+d},a("#exclude_dropdown").dropdown({className:{addition:"addition disabled"},fireOnInit:!0,fullTextSearch:!0,selectOnKeydown:!1,allowTab:!1,allowAdditions:!0,apiSettings:{url:ajaxurl+"/?search={query}",data:{action:"jme_exclude_search_users",nonce:a("#jme_exclude_nonce").val()},onComplete:function(b){b&&b.success&&b.results&&(o=a(b.results).length>0)}},hideAdditions:!1,minCharacters:3,showNoResults:!0,message:{addResult:"{term}"},onLabelCreate:function(b,d){var e=a(this);if(b.indexOf("userid_")!==-1)e.prepend("<i class='user circle outline icon'>");else{if(!c(b))return a("</div>");e.prepend("<i class='icon at'>")}return a(this)},onNoResults:function(a){return o=!1,!1},onShow:function(){b()}}),a("#jme_advanced_headers").accordion(),a("#send_test_email_modal").modal().modal("attach events","#send_test_email","show"),a(".hook_modals").modal({transition:"fade",observeChanges:!0,queue:!0,debug:!1,onHidden:function(){}}),p.modal("attach events","#hvt_back"),q.modal("attach events","#hook_template_modal .hook_view_template"),q.modal({onShow:function(){}}),a(".wp-editor-tabs").append('<button type="button" id="shortcodes-tab" class="shortcodes-tab">'+jmelocale.shortcodes+"</button>"),r.append('<div class="ui active dimmer transition hidden"><div class="ui text loader">'+jmelocale.attachments_loader+"</div></div>"),t.append('<div class="ui active dimmer transition hidden"><div class="ui text inverted loader">'+jmelocale.hook_loader+"</div></div>"),a("#toggle_email_status").click(function(b){b.preventDefault();var c=a(this),d=a("#hidden_post_status"),e=d.val(),f="",g="";c.removeClass("email_enabled email_disabled"),"publish"==e?(c.addClass("email_disabled"),f=c.data("enable"),g=c.data("isdisabled"),d.val("disabled")):(c.addClass("email_enabled"),f=c.data("disable"),g=c.data("isenabled"),d.val("publish")),a("#toggle_email_status_visible").html(g),a("#toggle_email_status_hidden").html(f),c.blur()}),a(".sc_conditionals .popover").popup({on:"click",position:"left center"}),s.dropdown({debug:!1}),u.dropdown({debug:!1,fireOnInit:!0,fullTextSearch:!0,onChange:function(a,b,c){!a&&c&&(a=c.data("value")),t.dimmer("show"),i(a),j(a),k(a),m(a),e(a),setTimeout(function(){t.dimmer("hide")},500)}}),a(".shortcode_item").dblclick(function(){n(a(this).data("shortcode"))}),a(".shortcode_sb_item").click(function(b){n(a(this).data("shortcode")),v.sidebar("toggle")}),v.sidebar({context:jQuery("#sc_pushable"),transition:"overlay"}).sidebar("attach events","#shortcodes-tab","toggle"),a("#templates-media-btn").click(function(b){b.preventDefault(),a("#hook_template_modal").modal("show")}),a(".hook_view_template").click(function(b){var c=a(this).data("hook"),d=a(this).data("group"),e=a(this).data("index"),f=h(c,d,e);a("#hvt_header").html(f.label),a("#hvt_action").html(c),a("#hvt_post_title").html(f.post_title),a("#hvt_to").html(f.to),a("#hvt_subject").html(f.subject),a("#hvt_post_content").text(f.post_content),f.attachments&&a(f.attachments).length>0?(a("#hvt_attachments").html(f.attachments.join(", ")),a("#hvt_attachments_row").show()):a("#hvt_attachments_row").hide(),w.data("hook",c),w.data("group",d),w.data("index",e)}),w.click(function(b){f(a(this).data("hook"),a(this).data("group"),a(this).data("index"))})});